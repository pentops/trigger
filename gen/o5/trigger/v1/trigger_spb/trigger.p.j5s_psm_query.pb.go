// Code generated by protoc-gen-go-psm. DO NOT EDIT.

package trigger_spb

import (
	context "context"
	psm "github.com/pentops/protostate/psm"
	sqrlx "github.com/pentops/sqrlx.go/sqrlx"
)

// State Query Service for %sTrigger
// QuerySet is the query set for the Trigger service.

type TriggerPSMQuerySet = psm.StateQuerySet[
	*TriggerGetRequest,
	*TriggerGetResponse,
	*TriggerListRequest,
	*TriggerListResponse,
	*TriggerEventsRequest,
	*TriggerEventsResponse,
]

func NewTriggerPSMQuerySet(
	smSpec psm.QuerySpec[
		*TriggerGetRequest,
		*TriggerGetResponse,
		*TriggerListRequest,
		*TriggerListResponse,
		*TriggerEventsRequest,
		*TriggerEventsResponse,
	],
	options psm.StateQueryOptions,
) (*TriggerPSMQuerySet, error) {
	return psm.BuildStateQuerySet[
		*TriggerGetRequest,
		*TriggerGetResponse,
		*TriggerListRequest,
		*TriggerListResponse,
		*TriggerEventsRequest,
		*TriggerEventsResponse,
	](smSpec, options)
}

type TriggerPSMQuerySpec = psm.QuerySpec[
	*TriggerGetRequest,
	*TriggerGetResponse,
	*TriggerListRequest,
	*TriggerListResponse,
	*TriggerEventsRequest,
	*TriggerEventsResponse,
]

func DefaultTriggerPSMQuerySpec(tableSpec psm.QueryTableSpec) TriggerPSMQuerySpec {
	return psm.QuerySpec[
		*TriggerGetRequest,
		*TriggerGetResponse,
		*TriggerListRequest,
		*TriggerListResponse,
		*TriggerEventsRequest,
		*TriggerEventsResponse,
	]{
		QueryTableSpec: tableSpec,
		ListRequestFilter: func(req *TriggerListRequest) (map[string]interface{}, error) {
			filter := map[string]interface{}{}
			return filter, nil
		},
		ListEventsRequestFilter: func(req *TriggerEventsRequest) (map[string]interface{}, error) {
			filter := map[string]interface{}{}
			filter["trigger_id"] = req.TriggerId
			return filter, nil
		},
	}
}

type TriggerQueryServiceImpl struct {
	db       sqrlx.Transactor
	querySet *TriggerPSMQuerySet
	UnsafeTriggerQueryServiceServer
}

var _ TriggerQueryServiceServer = &TriggerQueryServiceImpl{}

func NewTriggerQueryServiceImpl(db sqrlx.Transactor, querySet *TriggerPSMQuerySet) *TriggerQueryServiceImpl {
	return &TriggerQueryServiceImpl{
		db:       db,
		querySet: querySet,
	}
}

func (s *TriggerQueryServiceImpl) TriggerGet(ctx context.Context, req *TriggerGetRequest) (*TriggerGetResponse, error) {
	resObject := &TriggerGetResponse{}
	err := s.querySet.Get(ctx, s.db, req, resObject)
	if err != nil {
		return nil, err
	}
	return resObject, nil
}

func (s *TriggerQueryServiceImpl) TriggerList(ctx context.Context, req *TriggerListRequest) (*TriggerListResponse, error) {
	resObject := &TriggerListResponse{}
	err := s.querySet.List(ctx, s.db, req, resObject)
	if err != nil {
		return nil, err
	}
	return resObject, nil
}

func (s *TriggerQueryServiceImpl) TriggerEvents(ctx context.Context, req *TriggerEventsRequest) (*TriggerEventsResponse, error) {
	resObject := &TriggerEventsResponse{}
	err := s.querySet.ListEvents(ctx, s.db, req, resObject)
	if err != nil {
		return nil, err
	}
	return resObject, nil
}
